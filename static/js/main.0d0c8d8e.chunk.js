(this.webpackJsonp3dui=this.webpackJsonp3dui||[]).push([[0],{196:function(e,t,n){e.exports=n.p+"static/media/1_nx.6f124809.jpg"},197:function(e,t,n){e.exports=n.p+"static/media/1_ny.a23cd0ea.jpg"},198:function(e,t,n){e.exports=n.p+"static/media/1_nz.25825739.jpg"},199:function(e,t,n){e.exports=n.p+"static/media/1_px.8050c1af.jpg"},200:function(e,t,n){e.exports=n.p+"static/media/1_py.62522803.jpg"},201:function(e,t,n){e.exports=n.p+"static/media/1_pz.5b2a8580.jpg"},209:function(e,t,n){e.exports=n(228)},225:function(e,t,n){e.exports=n.p+"static/media/microphone.ca145fad.png"},228:function(e,t,n){"use strict";n.r(t);var r=n(20),a=n.n(r),i=n(148),c=n.n(i),o=n(129),s=n(171),u=n(166),l=n(167),f=n(172),h=n(170),p=n(138),d=n(69),b=n.n(d),m=n(107),g=n(208),v=n(117),O=n(15),x=function(e){Object(f.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,null)).authContext=e,r}return Object(l.a)(n,[{key:"fetch",value:function(){var e=Object(m.a)(b.a.mark((function e(t){var r,a,i=arguments;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.length>1&&void 0!==i[1]?i[1]:{},Object(O.isUrlAbsolute)(t)){e.next=3;break}throw new Error("You must supply absolute urls to PnPFetchClient.fetch.");case 3:return e.next=5,this.getToken(this.getResource(t));case 5:return a=e.sent,this.token=a,e.abrupt("return",Object(g.a)(Object(v.a)(n.prototype),"fetch",this).call(this,t,r));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getToken",value:function(){var e=Object(m.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={},-1!==t.indexOf("sharepoint")?n.scopes=["".concat(t,"/AllSites.Read")]:-1!==t.indexOf("graph")&&(n.scopes=["".concat(t,"/Group.Read.All"),"".concat(t,"/User.Read"),"".concat(t,"/profile")]),e.prev=2,e.next=5,this.authContext.acquireTokenSilent(n);case 5:return r=e.sent,e.abrupt("return",r.accessToken);case 9:if(e.prev=9,e.t0=e.catch(2),!this.requiresInteraction(e.t0.errorCode)){e.next=15;break}this.authContext.acquireTokenRedirect(n),e.next=16;break;case 15:throw e.t0;case 16:case"end":return e.stop()}}),e,this,[[2,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"requiresInteraction",value:function(e){return!(!e||!e.length)&&("consent_required"===e||"interaction_required"===e||"login_required"===e)}},{key:"getResource",value:function(e){var t=document.createElement("a");return t.href=e,"".concat(t.protocol,"//").concat(t.hostname)}}]),n}(O.BearerTokenFetchClient),j=new(n(231).a)({auth:{authority:"https://login.microsoftonline.com/8f2729c9-155b-42ae-99a6-6c8dd2e286d5",clientId:"993dcb6f-07c4-41dc-b789-0185c110408e"}});var y=function(e){return function(t){Object(f.a)(a,t);var n=Object(h.a)(a);function a(e){var t;return Object(u.a)(this,a),(t=n.call(this,e)).state={authenticated:!1,renewIframe:!1,hasError:!1,errorMessage:null},t}return Object(l.a)(a,[{key:"componentWillMount",value:function(){var e=this;j.handleRedirectCallback((function(){e.setState({authenticated:!0}),e.InitPnP()}),(function(t,n){console.log(t),e.setState({hasError:!0,errorMessage:t.errorMessage})})),j.isCallback(window.location.hash)?this.setState({renewIframe:!0}):j.getAccount()?(this.setState({authenticated:!0}),this.InitPnP()):j.loginRedirect({})}},{key:"render",value:function(){return this.state.renewIframe?r.createElement("div",null,"hidden renew iframe - not visible"):this.state.authenticated?r.createElement(e,this.props):this.state.hasError?r.createElement("div",null,this.state.errorMessage):r.createElement("div",null,"Login in progress...")}},{key:"InitPnP",value:function(){console.log("init pnp");p.a.setup({sp:{fetchClientFactory:function(){return new x(j)},baseUrl:"https://openpoint.sharepoint.com"}})}}]),a}(r.Component)},C=n(195),E=n(51),S=n(196),k=n.n(S),w=n(197),T=n.n(w),I=n(198),M=n.n(I),_=n(199),R=n.n(_),L=n(200),B=n.n(L),P=n(201),A=n.n(P),U=[R.a,B.a,A.a,k.a,T.a,M.a],F=n(132),q=["skyBox"],z=function(e,t){var n=F.a.CreateFullscreenUI("UI"),r=function(e){var t=F.b.CreateSimpleButton("but");return t.width="350px",t.height="40px",t.color="white",t.cornerRadius=20,t.background="green",t.alpha="0.5",t.horizontalAlignment=F.c.HORIZONTAL_ALIGNMENT_LEFT,t.verticalAlignment=F.c.VERTICAL_ALIGNMENT_BOTTOM,e.addControl(t),t.textBlock}(n),a=function(e){var t=new F.d;return t.alpha=.5,t.lineWidth=5,t.dash=[5,10],t.isVisible=!1,e.addControl(t),t}(n);a.connectedControl=r,e.onPointerObservable.add((function(n){if(n.type==E.i.POINTERMOVE){var i=function(e){var t=e.createPickingRay(e.pointerX,e.pointerY,E.g.Identity(),e.activeCameras[0]),n=e.pickWithRay(t);return n.pickedMesh&&-1==q.findIndex((function(e){return e.toUpperCase()==n.pickedMesh.name.toUpperCase()}))?n.pickedMesh:null}(e);if(i){var c=t.find((function(e){return i.name==e.id}));r.text=c.title,a.linkWithMesh(i),a.isVisible=!0}else r.text="",a.isVisible=!1,a.linkWithMesh(null)}}))},G=n(207),H=function(e){return Math.ceil(Math.random()*e)},D=function(e){var t=e.type,n=e.ServiceAction;return function(){var e=Object(m.a)(b.a.mark((function e(r,a){var i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r({type:t}),e.prev=1,e.next=4,n(a);case 4:return i=e.sent,r({type:"".concat(t,"_SUCCESS"),payload:i}),e.abrupt("return",i);case 9:e.prev=9,e.t0=e.catch(1),r({type:"".concat(t,"_ERROR"),payload:e.t0});case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}()},N=null,V=null,W=null,Y=function(e){W=e;var t=function(e){var t=new E.m(30,15,-100),n=new E.f("camera1",t,e);return n.attachControl(e.getEngine().getRenderingCanvas(),!0),n.angularSensibility=5e3,e.createDefaultLight(),e.actionManager=new E.a(e),{camera:n,startCameraPos:t}}(e);t.camera,t.startCameraPos;!function(e){var t=E.h.CreateBox("skyBox",{size:1e3},e),n=new E.k("skyBox",e);n.backFaceCulling=!1,n.reflectionTexture=new E.d("",e,null,!1,U),n.reflectionTexture.coordinatesMode=E.l.SKYBOX_MODE,n.diffuseColor=new E.b(0,0,0),n.specularColor=new E.b(0,0,0),t.material=n}(e),z(e,V),function(e){for(var t=e.baseMeshes,n=e.objects,r=void 0===n?[]:n,a=e.xDim,i=void 0===a?H(10):a,c=e.yDim,o=void 0===c?H(10):c,s=e.distance,u=void 0===s?20:s,l=e.maxSize,f=void 0===l?5:l,h=Math.max.apply(Math,Object(G.a)(r.map((function(e){return e.count})))),p=0;p<r.length;p++){var d=t[0].createInstance(r[p].id),b=p%i,m=(p-b)/i%o,g=((p-b)/i-m)/o;d.position.x=b*u,d.position.y=m*u,d.position.z=g*u;var v=Math.ceil(r[p].count/h*f);v=0==v?1:v,d.scaling=new E.m(v,v,v),d.instancedBuffers.color=new E.c(Math.random(),Math.random(),Math.random(),Math.random())}}({baseMeshes:N=function(){var e=[],t=E.h.CreateSphere("baseSphere",{segments:16,diameter:2});return t.isVisible=!1,t.registerInstancedBuffer("color",4),t.instancedBuffers.color=new E.c(1,1,1,1),e.push(t),e}(),objects:V,xDim:3,yDim:3})},J=function(e){},X=function(e){var t=e.lists,n=e.objectToSearch;return V=t,Object(r.useEffect)((function(){n&&function(e){if(!(e.length<=2)){var t=V.find((function(t){return t.name.toUpperCase().indexOf(e.toUpperCase())>-1}));if(t&&N.length>0){var n=N[0].instances.find((function(e){return e.name==t.id}));n.absolutePosition;W.cameras[0].setTarget(n.getBoundingInfo().boundingBox.minimumWorld)}}}(n)}),[n]),a.a.createElement(C.a,{antialias:!0,onSceneReady:function(e){return Y(e)},onRender:J,id:"my-canvas"})},K=Object(o.b)((function(e){return{lists:e.site.lists,listsfetching:e.site.listsfetching,listsfetched:e.site.listsfetched}}))(X),Z=n(173),Q=n.n(Z),$=n(174),ee=n(175);n(225);function te(){var e=Object($.a)(["\n  fill: lightblue;\n"]);return te=function(){return e},e}function ne(){var e=Object($.a)(["\n  cursor: pointer;\n  font-size: 25px;\n"]);return ne=function(){return e},e}function re(){var e=Object($.a)(["\n  cursor: pointer;\n  text:hover {\n    cursor: pointer;\n  }\n  top: ",";\n  left: ",";\n  position: absolute;\n  opacity: 0.5;\n\n  :hover {\n    opacity: 1;\n  }\n"]);return re=function(){return e},e}var ae=ee.a.svg(re(),(function(e){return e.top}),(function(e){return e.left})),ie=ee.a.text(ne()),ce=ee.a.circle(te()),oe=function(e){var t=e.start,n=e.TurnSpeech;return a.a.createElement(ae,{top:"".concat(window.innerHeight-180,"px"),left:"20px",height:"44px",width:"44px",onClick:function(){return n(!t)}},a.a.createElement(ce,{cx:"50%",cy:"50%",r:"22"}),a.a.createElement(ie,{textAnchor:"middle",x:"50%",y:"70%"},t?"On":"Off"))},se=function(e){var t=e.GetCommand,n=Object(r.useState)(!1),i=Object(s.a)(n,2),c=i[0],o=i[1],u=Object(Z.useSpeechRecognition)(),l=u.transcript;u.startListening,u.stopListening;return Object(r.useEffect)((function(){c?Q.a.startListening({language:"en-US"}):Q.a.stopListening()}),[c]),Object(r.useEffect)((function(){l&&(console.log(l),t(l),o(!1))}),[l]),a.a.createElement(oe,{start:c,TurnSpeech:function(e){return o(e)}})},ue=y((function(e){var t=e.GetLists,n=e.listsfetching,i=e.listsfetched,c=Object(r.useState)(""),o=Object(s.a)(c,2),u=o[0],l=o[1];return n||i||t(),i?a.a.createElement(a.a.Fragment,null,a.a.createElement(se,{GetCommand:function(e){return l(e)}}),a.a.createElement(K,{objectToSearch:u})):a.a.createElement("div",null,"Loading...")})),le=n(100),fe=(n(227),n(229),function(e){return e.map((function(e){return{title:"".concat(e.Title," (").concat(e.ItemCount,")"),name:e.Title,count:e.ItemCount,id:e.Id}}))}),he=function(){return D({type:"FETCH_LISTS",ServiceAction:function(){var e=Object(m.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=fe,e.next=3,p.a.web.lists.get();case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()})},pe=Object(o.b)((function(e){return{listsfetching:e.site.listsfetching,listsfetched:e.site.listsfetched}}),(function(e){return Object(le.b)({GetLists:he},e)}))(ue),de=n(205),be=n(206),me=n(102),ge=Object(le.c)({site:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{title:"",sitefetching:!1,sitefetched:!1,lists:[],listsfetching:!1,listsfetched:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_LISTS":return Object(me.a)(Object(me.a)({},e),{},{listsfetched:!1,listsfetching:!0});case"".concat("FETCH_LISTS","_SUCCESS"):return Object(me.a)(Object(me.a)({},e),{},{listsfetched:!0,listsfetching:!1,lists:t.payload});case"FETCH_SITE":return Object(me.a)(Object(me.a)({},e),{},{sitefetching:!0,sitefetched:!1});case"".concat("FETCH_SITE","_SUCCESS"):return Object(me.a)(Object(me.a)({},e),{},{sitefetching:!1,sitefetched:!0,title:t.payload.Title})}return e}}),ve=Object(le.d)(ge,Object(le.a)(be.a,Object(de.createLogger)())),Oe=function(){return a.a.createElement(o.a,{store:ve},a.a.createElement(pe,null))};c.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(Oe,null)),document.getElementById("root"))}},[[209,1,2]]]);
//# sourceMappingURL=main.0d0c8d8e.chunk.js.map