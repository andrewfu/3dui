(this.webpackJsonp3dui=this.webpackJsonp3dui||[]).push([[0],{45:function(e,t,n){e.exports=n(56)},56:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),c=n(25),i=n.n(c),o=n(29),s=n(27),u=n(28),l=n(32),h=n(30),f=n(31),p=n(13),d=n.n(p),b=n(18),v=n(44),g=n(17),m=n(0),O=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,null)).authContext=e,r}return Object(u.a)(n,[{key:"fetch",value:function(){var e=Object(b.a)(d.a.mark((function e(t){var r,a,c=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=c.length>1&&void 0!==c[1]?c[1]:{},Object(m.isUrlAbsolute)(t)){e.next=3;break}throw new Error("You must supply absolute urls to PnPFetchClient.fetch.");case 3:return e.next=5,this.getToken(this.getResource(t));case 5:return a=e.sent,this.token=a,e.abrupt("return",Object(v.a)(Object(g.a)(n.prototype),"fetch",this).call(this,t,r));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getToken",value:function(){var e=Object(b.a)(d.a.mark((function e(t){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={},-1!==t.indexOf("sharepoint")?n.scopes=["".concat(t,"/AllSites.Read")]:-1!==t.indexOf("graph")&&(n.scopes=["".concat(t,"/Group.Read.All"),"".concat(t,"/User.Read"),"".concat(t,"/profile")]),e.prev=2,e.next=5,this.authContext.acquireTokenSilent(n);case 5:return r=e.sent,e.abrupt("return",r.accessToken);case 9:if(e.prev=9,e.t0=e.catch(2),!this.requiresInteraction(e.t0.errorCode)){e.next=15;break}this.authContext.acquireTokenRedirect(n),e.next=16;break;case 15:throw e.t0;case 16:case"end":return e.stop()}}),e,this,[[2,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"requiresInteraction",value:function(e){return!(!e||!e.length)&&("consent_required"===e||"interaction_required"===e||"login_required"===e)}},{key:"getResource",value:function(e){var t=document.createElement("a");return t.href=e,"".concat(t.protocol,"//").concat(t.hostname)}}]),n}(m.BearerTokenFetchClient),j=new(n(59).a)({auth:{authority:"https://login.microsoftonline.com/8f2729c9-155b-42ae-99a6-6c8dd2e286d5",clientId:"993dcb6f-07c4-41dc-b789-0185c110408e"}});var k=function(e){return function(t){Object(l.a)(a,t);var n=Object(h.a)(a);function a(e){var t;return Object(s.a)(this,a),(t=n.call(this,e)).state={authenticated:!1,renewIframe:!1,hasError:!1,errorMessage:null},t}return Object(u.a)(a,[{key:"componentWillMount",value:function(){var e=this;j.handleRedirectCallback((function(){e.setState({authenticated:!0}),e.InitPnP()}),(function(t,n){console.log(t),e.setState({hasError:!0,errorMessage:t.errorMessage})})),j.isCallback(window.location.hash)?this.setState({renewIframe:!0}):j.getAccount()?(this.setState({authenticated:!0}),this.InitPnP()):j.loginRedirect({})}},{key:"render",value:function(){return this.state.renewIframe?r.createElement("div",null,"hidden renew iframe - not visible"):this.state.authenticated?r.createElement(e,this.props):this.state.hasError?r.createElement("div",null,this.state.errorMessage):r.createElement("div",null,"Login in progress...")}},{key:"InitPnP",value:function(){console.log("init pnp");f.a.setup({sp:{fetchClientFactory:function(){return new O(j)},baseUrl:"https://openpoint.sharepoint.com"}})}}]),a}(r.Component)}((function(e){var t=e.siteTitle,n=e.GetSite,r=e.sitefetching,c=e.sitefetched;r||c||n();return c?a.a.createElement("div",null,t):a.a.createElement("div",null,"Loading...")})),y=n(14),E=(n(57),function(){return function(e){var t=e.type,n=e.ServiceAction;return function(){var e=Object(b.a)(d.a.mark((function e(r,a){var c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r({type:t}),e.prev=1,e.next=4,n(a);case 4:return c=e.sent,r({type:"".concat(t,"_SUCCESS"),payload:c}),e.abrupt("return",c);case 9:e.prev=9,e.t0=e.catch(1),r({type:"".concat(t,"_ERROR"),payload:e.t0});case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}()}({type:"FETCH_SITE",ServiceAction:function(){var e=Object(b.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.web.get();case 2:return t=e.sent,console.log(t.Title),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()})}),w=Object(o.b)((function(e){return{siteTitle:e.site.title,sitefetching:e.site.sitefetching,sitefetched:e.site.sitefetched}}),(function(e){return Object(y.b)({GetSite:E},e)}))(k),S=n(42),x=n(43),C=n(24),T=Object(y.c)({site:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{title:"",sitefetching:!1,sitefetched:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_SITE":return Object(C.a)(Object(C.a)({},e),{},{sitefetching:!0,sitefetched:!1});case"".concat("FETCH_SITE","_SUCCESS"):return Object(C.a)(Object(C.a)({},e),{},{sitefetching:!1,sitefetched:!0,title:t.payload.Title})}return e}}),I=Object(y.d)(T,Object(y.a)(x.a,Object(S.createLogger)())),R=function(){return a.a.createElement(o.a,{store:I},a.a.createElement(w,null))};i.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(R,null)),document.getElementById("root"))}},[[45,1,2]]]);
//# sourceMappingURL=main.561e1151.chunk.js.map