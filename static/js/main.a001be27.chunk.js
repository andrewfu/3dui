(this.webpackJsonp3dui=this.webpackJsonp3dui||[]).push([[0],{184:function(e,t,n){e.exports=n.p+"static/media/1_nx.6f124809.jpg"},185:function(e,t,n){e.exports=n.p+"static/media/1_ny.a23cd0ea.jpg"},186:function(e,t,n){e.exports=n.p+"static/media/1_nz.25825739.jpg"},187:function(e,t,n){e.exports=n.p+"static/media/1_px.8050c1af.jpg"},188:function(e,t,n){e.exports=n.p+"static/media/1_py.62522803.jpg"},189:function(e,t,n){e.exports=n.p+"static/media/1_pz.5b2a8580.jpg"},193:function(e,t,n){e.exports=n(204)},204:function(e,t,n){"use strict";n.r(t);var r=n(28),a=n.n(r),i=n(140),c=n.n(i),o=n(161),s=n(157),u=n(158),l=n(164),h=n(162),p=n(163),d=n(85),f=n.n(d),g=n(113),v=n(192),m=n(112),b=n(17),k=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,null)).authContext=e,r}return Object(u.a)(n,[{key:"fetch",value:function(){var e=Object(g.a)(f.a.mark((function e(t){var r,a,i=arguments;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.length>1&&void 0!==i[1]?i[1]:{},Object(b.isUrlAbsolute)(t)){e.next=3;break}throw new Error("You must supply absolute urls to PnPFetchClient.fetch.");case 3:return e.next=5,this.getToken(this.getResource(t));case 5:return a=e.sent,this.token=a,e.abrupt("return",Object(v.a)(Object(m.a)(n.prototype),"fetch",this).call(this,t,r));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getToken",value:function(){var e=Object(g.a)(f.a.mark((function e(t){var n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={},-1!==t.indexOf("sharepoint")?n.scopes=["".concat(t,"/AllSites.Read")]:-1!==t.indexOf("graph")&&(n.scopes=["".concat(t,"/Group.Read.All"),"".concat(t,"/User.Read"),"".concat(t,"/profile")]),e.prev=2,e.next=5,this.authContext.acquireTokenSilent(n);case 5:return r=e.sent,e.abrupt("return",r.accessToken);case 9:if(e.prev=9,e.t0=e.catch(2),!this.requiresInteraction(e.t0.errorCode)){e.next=15;break}this.authContext.acquireTokenRedirect(n),e.next=16;break;case 15:throw e.t0;case 16:case"end":return e.stop()}}),e,this,[[2,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"requiresInteraction",value:function(e){return!(!e||!e.length)&&("consent_required"===e||"interaction_required"===e||"login_required"===e)}},{key:"getResource",value:function(e){var t=document.createElement("a");return t.href=e,"".concat(t.protocol,"//").concat(t.hostname)}}]),n}(b.BearerTokenFetchClient),E=new(n(207).a)({auth:{authority:"https://login.microsoftonline.com/8f2729c9-155b-42ae-99a6-6c8dd2e286d5",clientId:"993dcb6f-07c4-41dc-b789-0185c110408e"}});var w=function(e){return function(t){Object(l.a)(a,t);var n=Object(h.a)(a);function a(e){var t;return Object(s.a)(this,a),(t=n.call(this,e)).state={authenticated:!1,renewIframe:!1,hasError:!1,errorMessage:null},t}return Object(u.a)(a,[{key:"componentWillMount",value:function(){var e=this;E.handleRedirectCallback((function(){e.setState({authenticated:!0}),e.InitPnP()}),(function(t,n){console.log(t),e.setState({hasError:!0,errorMessage:t.errorMessage})})),E.isCallback(window.location.hash)?this.setState({renewIframe:!0}):E.getAccount()?(this.setState({authenticated:!0}),this.InitPnP()):E.loginRedirect({})}},{key:"render",value:function(){return this.state.renewIframe?r.createElement("div",null,"hidden renew iframe - not visible"):this.state.authenticated?r.createElement(e,this.props):this.state.hasError?r.createElement("div",null,this.state.errorMessage):r.createElement("div",null,"Login in progress...")}},{key:"InitPnP",value:function(){console.log("init pnp");p.a.setup({sp:{fetchClientFactory:function(){return new k(E)},baseUrl:"https://openpoint.sharepoint.com"}})}}]),a}(r.Component)},y=n(183),x=n(63),O=n(125),j=n(184),C=n.n(j),M=n(185),S=n.n(M),R=n(186),T=n.n(R),L=n(187),I=n.n(L),P=n(188),_=n.n(P),q=n(189),B=n.n(q),A=[I.a,_.a,B.a,C.a,S.a,T.a],F=null,z=function(e){var t=new x.k(30,15,-100),n=new x.e("camera1",t,e),r=e.getEngine().getRenderingCanvas();n.attachControl(r,!0),n.angularSensibility=5e3,e.createDefaultLight();var a=x.g.CreateBox("skyBox",{size:1e3},e),i=new x.i("skyBox",e);i.backFaceCulling=!1,i.reflectionTexture=new x.c("",e,null,!1,A),i.reflectionTexture.coordinatesMode=x.j.SKYBOX_MODE,i.diffuseColor=new x.a(0,0,0),i.specularColor=new x.a(0,0,0),a.material=i;var c=O.a.CreateFullscreenUI("UI");(F=x.g.CreateSphere("baseSphere",{segments:16,diameter:2})).isVisible=!1,F.registerInstancedBuffer("color",4),F.instancedBuffers.color=new x.b(1,1,1,1),G(F);var o=V(c),s=!1,u=new O.d;u.alpha=.5,u.lineWidth=5,u.dash=[5,10],u.isVisible=!1,c.addControl(u),u.connectedControl=o,e.onPointerMove=function(){var t=e.createPickingRay(e.pointerX,e.pointerY,x.f.Identity(),n),r=e.pickWithRay(t);if(r.pickedMesh){var a=Math.ceil(r.pickedMesh.position.subtract(n.position).length());o.text="".concat(r.pickedMesh.name,"-").concat(a),u.linkWithMesh(r.pickedMesh),u.isVisible=!0}else o.text="",u.isVisible=!1,u.linkWithMesh(null)},e.onPointerDown=function(){s||(r.requestPointerLock=r.requestPointerLock||r.msRequestPointerLock||r.mozRequestPointerLock||r.webkitRequestPointerLock,r.requestPointerLock&&r.requestPointerLock());var a=e.createPickingRay(e.pointerX,e.pointerY,x.f.Identity(),n);if(e.pickWithRay(a).pickedMesh){for(var i=F.instances.length,c=0;c<i;c++)F.instances[F.instances.length-1].dispose();G(F),n.position=t,u.isVisible=!1}};var l=function(){var e=document.mozPointerLockElement||document.webkitPointerLockElement||document.msPointerLockElement||document.pointerLockElement||null;s=!!e};document.addEventListener("pointerlockchange",l,!1),document.addEventListener("mspointerlockchange",l,!1),document.addEventListener("mozpointerlockchange",l,!1),document.addEventListener("webkitpointerlockchange",l,!1),e.registerBeforeRender((function(){}))},U=function(e){},V=function(e){var t=O.b.CreateSimpleButton("but");return t.width="350px",t.height="40px",t.color="white",t.cornerRadius=20,t.background="green",t.alpha="0.5",t.horizontalAlignment=O.c.HORIZONTAL_ALIGNMENT_LEFT,t.verticalAlignment=O.c.VERTICAL_ALIGNMENT_BOTTOM,e.addControl(t),t.textBlock},W=function(e){return Math.ceil(Math.random()*e)},G=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:W(100),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:W(10),r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:W(10),a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10,i=0;i<t;i++){var c=e.createInstance("".concat(e.name).concat(i)),o=i%n,s=(i-o)/n%r,u=((i-o)/n-s)/r;c.position.x=o*a,c.position.y=s*a,c.position.z=u*a;var l=W(3);c.scaling=new x.k(l,l,l),c.instancedBuffers.color=new x.b(Math.random(),Math.random(),Math.random(),Math.random())}},N=function(){return a.a.createElement(y.a,{antialias:!0,onSceneReady:z,onRender:U,id:"my-canvas"})},H=w((function(e){e.siteTitle;var t=e.GetSite,n=e.sitefetching,r=e.sitefetched;return n||r||t(),r?a.a.createElement(N,null):a.a.createElement("div",null,"Loading...")})),Y=n(97),D=(n(205),function(){return function(e){var t=e.type,n=e.ServiceAction;return function(){var e=Object(g.a)(f.a.mark((function e(r,a){var i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r({type:t}),e.prev=1,e.next=4,n(a);case 4:return i=e.sent,r({type:"".concat(t,"_SUCCESS"),payload:i}),e.abrupt("return",i);case 9:e.prev=9,e.t0=e.catch(1),r({type:"".concat(t,"_ERROR"),payload:e.t0});case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}()}({type:"FETCH_SITE",ServiceAction:function(){var e=Object(g.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.web.get();case 2:return t=e.sent,console.log(t.Title),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()})}),X=Object(o.b)((function(e){return{siteTitle:e.site.title,sitefetching:e.site.sitefetching,sitefetched:e.site.sitefetched}}),(function(e){return Object(Y.b)({GetSite:D},e)}))(H),J=n(190),K=n(191),Z=n(130),Q=Object(Y.c)({site:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{title:"",sitefetching:!1,sitefetched:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_SITE":return Object(Z.a)(Object(Z.a)({},e),{},{sitefetching:!0,sitefetched:!1});case"".concat("FETCH_SITE","_SUCCESS"):return Object(Z.a)(Object(Z.a)({},e),{},{sitefetching:!1,sitefetched:!0,title:t.payload.Title})}return e}}),$=Object(Y.d)(Q,Object(Y.a)(K.a,Object(J.createLogger)())),ee=function(){return a.a.createElement(o.a,{store:$},a.a.createElement(X,null))};c.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(ee,null)),document.getElementById("root"))}},[[193,1,2]]]);
//# sourceMappingURL=main.a001be27.chunk.js.map